!function(e){"use strict";function t(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function r(e,t){(s(e,t)?i:a)(e,t)}var s,a,i;"classList"in document.documentElement?(s=function(e,t){return e.classList.contains(t)},a=function(e,t){e.classList.add(t)},i=function(e,t){e.classList.remove(t)}):(s=function(e,r){return t(r).test(e.className)},a=function(e,t){s(e,t)||(e.className=e.className+" "+t)},i=function(e,r){e.className=e.className.replace(t(r)," ")});var o={hasClass:s,addClass:a,removeClass:i,toggleClass:r,has:s,add:a,remove:i,toggle:r};"function"==typeof define&&define.amd?define(o):"object"==typeof exports?module.exports=o:e.classie=o}(window),function(e){"use strict";var t=function(e,t){for(var r in t)e[r]=t[r];return e},r=function(e,r,s){this._checkSelector(e)&&(this.$el=document.querySelector(e),this._params=t(this._params,r),this.$formLabels=[].slice.call(this.$el.querySelectorAll(this._params.selectorFormLabels)),this.$formControls=[].slice.call(this.$el.querySelectorAll(this._params.selectorFormControls)),this.inputs={},this.$submitBtn,this.errors=0,this._init())};r.prototype._checkSelector=function(e){return document.querySelector(e)},r.prototype._params={selectorFormLabels:".form__label",selectorFormControls:".form__control",selectorErrorDiv:".form__error",selectorSubmitBtn:".js-form-submit",classNameActive:"form__item_active",classNameFocused:"form__item_focused",classNameError:"form__item_error",defaultErrorText:"необходимо заполнить",invalidErrorText:"неверный формат",displayError:!1,regExp:{email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,phone:/^(\+7|8)([0-9]{3})([0-9]{3})([0-9]{2})([0-9]{2})$/},customValidation:{}},r.prototype._init=function(){this._initEventForLabels(),this._initSubmitBtn(),this._initFormCtrls()},r.prototype._initEventForLabels=function(){var e=this;this.$formLabels.forEach(function(t){e._addEventForLabel(t)})},r.prototype._addEventForLabel=function(e){var t=this;e.addEventListener("click",function(){var e=this.parentNode;classie.add(e,t._params.classNameActive),classie.add(e,t._params.classNameFocused),this.previousElementSibling.focus()})},r.prototype._initSubmitBtn=function(){this.$submitBtn=this.$el.querySelector(this._params.selectorSubmitBtn),this.$submitBtn.disabled=!0},r.prototype._initFormCtrls=function(){var e=this;this.$formControls.forEach(function(t,r){if(!e.inputs.hasOwnProperty(t.name)){var s={id:r,$el:t,type:t.type,field:t.getAttribute("data-field"),name:t.name,value:t.value,required:t.hasAttribute("_required"),rule:null,error:!1,errorText:null,changed:!1,active:!1,valid:!1};e.inputs[t.name]=s}e._addInputEvent(t)})},r.prototype._addInputEvent=function(e){var t=this;"text"===e.type?(e.addEventListener("focus",function(){var e=this.parentNode;classie.has(e,t._params.classNameActive)||classie.add(e,t._params.classNameActive),classie.has(e,t._params.classNameFocused)||classie.add(e,t._params.classNameFocused)}),e.addEventListener("keyup",function(){t._setInputStatusChanged(this.name),t._validate()}),e.addEventListener("blur",function(){var e=this.parentNode;this.value||classie.remove(e,t._params.classNameActive),classie.remove(e,t._params.classNameFocused)})):"checkbox"===e.type&&e.addEventListener("change",function(){t._validate()})},r.prototype._setInputStatusChanged=function(e){this.inputs[e].changed||(this.inputs[e].changed=!0)},r.prototype._validate=function(){for(var e in this.inputs){var t=this.inputs[e];if(t.required){var r=this._validateInput(t);r.errorText?(t.error=!0,t.errorText=r.errorText,t.valid=!1):(t.error=!1,t.errorText="",t.valid=!0)}}this._outErrors()},r.prototype._validateInput=function(e){var t=this;switch(e.field){case"checkbox":return function(e){return{errorText:null,value:e}}(e.$el.checked);default:return function(e){return t._getError(e)}(e)}},r.prototype._getError=function(e){var t={errorText:"",value:e.$el.value.trim()};return"empty"===this._defineErrorType(e)?t.errorText=this._params.customValidation.hasOwnProperty(e.field)&&this._params.customValidation[e.field].hasOwnProperty("empty")?this._params.customValidation[e.field].empty.errorText:this._params.defaultErrorText:this._params.customValidation.hasOwnProperty(e.field)&&this._params.customValidation[e.field].hasOwnProperty("invalid")?this._params.customValidation[e.field].invalid.hasOwnProperty("regExp")?t.errorText=this._params.customValidation[e.field].invalid.regExp.test(e.$el.value)?null:this._params.customValidation[e.field].invalid.errorText:t.errorText=this._params.regExp[e.field].test(e.$el.value)?null:this._params.customValidation[e.field].invalid.errorText:t.errorText=this._checkInputValueByRegExp(e),t},r.prototype._checkInputValueByRegExp=function(e){return this._checkDefaultRegExp(e)?this._params.regExp[e.field].test(e.$el.value)?null:this._params.invalidErrorText:null},r.prototype._checkDefaultRegExp=function(e){return this._params.regExp.hasOwnProperty(e.field)},r.prototype._defineErrorType=function(e){return e.$el.value.trim()?"invalid":"empty"},r.prototype._outErrors=function(){this.errors=0;for(var e in this.inputs){var t=this.inputs[e],r=t.$el.parentNode,s=r.querySelector(this._params.selectorErrorDiv);t.error&&this.errors++,t.error&&t.changed?(s&&this._params.displayError&&(s.innerText=t.errorText),classie.add(r,this._params.classNameError),classie.add(t.$el,"_error")):(s&&(s.innerText=""),classie.remove(r,this._params.classNameError),classie.remove(t.$el,"_error")),!t.error&&t.valid&&t.changed&&classie.add(r,this._params.classNameActive)}this.$submitBtn.disabled=this.errors>0},r.prototype.resetForm=function(){var e=this;this.$formControls.forEach(function(t){t.value="",classie.remove(t,"_error"),classie.remove(t.$el.parentNode,e._params.classNameError),classie.remove(t.$el.parentNode,e._params.classNameActive)}),this.$submitBtn.disabled=!0},e.SmartFormValidator=r}(window);